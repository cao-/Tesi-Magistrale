

%In the previous section we showed that the interesting behaviour of the regularity vector~$\Bm Q$ is achieved in the flat limit, that is when the  parameter~$ε$ determining the shape of the basis functions approaches the value~$0$.

%Therefore, it  is of our interest to compute the limit value of this vector in order to analyse a given sample of data~$(X, F)$.
From the numerical point of view, it  may be problematic to  actually  compute a good approximation of~$\Bm Q\.$ when $ε\to0$.  In fact, as $ε$ becomes smaller and smaller, the rows (and the columns) of the interpolation matrix~$\Bm A$ become increasingly similar one to another, and the procedure  devised in Proposition~\ref[Ucomputation] to efficiently compute the values of the vector~$\Bm U$, and hence the values of~$\Bm Q\.$, may be unstable\fnote{Refer to the end of Section~\ref[errorsec] for other considerations about the stability of the standard interpolation algorithm.}$\!\.\!\!$,\,\, because it involves the inverse of the matrix~$\Bm A$. 


Fortunately, if the employed radial function~$\phi$ is not too much regular, numerical tests show that there is a wide interval~$I$ of values for~$ε$ that allow to obtain a very good approximation of the limit value of~$\Bm Q\.$, before incurring in malconditioning problems. 
Figure~\ref[limitQfig] shows what happens when $\phi$ is one of the Wendland's functions of Table~\ref[wentab] or the Gaussian function of Example~\ref[gaussianex]. From that picture it seems apparent that the range~$I$ of values in which~$ε\.$ can be chosen decreses as the regularity of~$\phi$ increases.  When the regularity is high, either it may be hard to pick a value of~$ε$ such that~$ε\in I$, or it may even be impossible, because $I=\emptyset$, which means that the limit value of~$\Bm Q$ is numerically never reached.  For the applications that we have in mind---either detecting function discontinuities or gradient faults---this fact doesn't constitute a big problem.  In fact, we'll be interested in using mainly the $\Cal C^0$ or~$\Cal C^2$ functions.





One way to improve stability when computing~$\Bm Q\.$ for a given set~$(X, F)$ of sampled data is to bring~$F$ closer to the origin before actually performing the computations, by taking adavantage of Property~\ref[translprop] and replacing~$F$ with  $G = F-\mathop{\rm mean}(F)$, for instance. In fact, it can be observed either using the considerations made in the proofs of Property~\ref[flatlimit] and Property~\ref[translprop], or also from  numerical tests, that this shift allows to obtain the same level of approximation for~$\lim_{ε\to 0} \Bm Q\.$ by using bigger values of~$ε$, that are less likely to produce a malconditioned interpolation matrix.


An interesting fact to notice is that the vector~$\Bm Q$ detects different kinds of function irregularities, depending on the used radial function~$\phi$.  We considered four functions~$f_1$, $f_2$, $f_3$, $f_4$, defined on the interval~$[-1,1]\subset\R$, such that: $f_1$ is discontinuous; $f_2$ is of class~$\Cal C^0$ but not~$\Cal C^1$; $f_3$ is of class~$\Cal C^2$ but not~$\Cal C^1$; and $f_4$ is~$\Cal C^\infty$.  Precisely, they are defined as
$$
f_1(x) =\cases{x, & if $x<0$\cr
               x^2+1 & if $x\geq 0$,}
$$
\vskip0ex
$$
f_2(x) =\mathop{\rm abs}(x),\qquad
f_3(x)=\mathop{\rm abs}(x)^{3/2},\qquad
f_4(x) = \sin(x).
$$
After having sampled each of these functions at a set~$X$ of $25$ uniformly spaced points in~$[-1,1]$, we computed the $\phi$-regularity vector~$\Bm Q$ using three different radial functions~$\phi$, namely the Wendland's $\Cal C^0$, $\Cal C^2$ and~$\Cal C^4$ functions.  The vector~$\Bm Q$ was computed using a value of~$\varepsilon$ in the range that produces a good approximation for the limit value~$\lim_{\varepsilon\to 0}\Bm Q$.  The sampled functions and the computed components of~$\Bm Q$ are shown in Figure~\ref[diffregular].

We see that the Wendland's $\Cal C^0$ function detects the discontinuity of~$f_1$, it almost doesn't see the gradient discontinuity of~$f_2$ (the small signal detected at the point~$x=0$ vanishes as the number  of sampled points is increased), and it doesn't detect the discontinuity of the second derivative in the case of~$f_3$.  Instead, both the Wendland's $\Cal C^2$ and~$\Cal C^4$ functions can detect, with signals of different amplitude, the irregularities of $f_2$ and~$f_3$.  Finally, neither of the considered radial functions  detect any irregularity in the smooth function~$f_4$, except some small signals at the boundary of the domain.



\label[limitQfig]
\pageinsert
\kern-0.78cm
\bgroup
\typoscale[900/900]
\picw=1.2\hsize
\line{\hss\inkinspic{limitQ2.pdf}\hbox{\kern1.5em}\hss}
\egroup
\kern-11.3ex
\caption/f
From a set~$(X, F)$ of data (shown at the top), where $X\subset[0,1]\subset\R$ we computed the vector~$\Bm Q\.$ for some radial functions~$\phi$, letting~$\varepsilon$ vary.  For simplicity, we didn't plot the value of each single component of~$\Bm Q\.$, but only the value~$\norm{\Bm Q}_1$. In each graph the abscissae represent the values of~$\varepsilon$ in a logarithmic scale, and the shown range of values differs from one graph to another.  %For each graph, except the last one, there is an interval~$I$ where~$\norm{\Bm Q}_1$ doesn't change much (the graph is flat), meaning that a good approximation of~$\lim_{ε\to0}\Bm Q$ is reached; for value of~$ε$ still smaller there is an abrupt deviation due to numerical instability, and the obtained values are unreliable.   In the case of the Gaussian function we don't see any flat area in the graph: this means that malconditioning problems step in before the limit value of~$\Bm Q$ is reached.
\bigskip
\endinsert




\label[diffregular]
\pageinsert
\kern-0.78cm
\bgroup
\picw=.53\hsize
\line{\hss\inspic{reg_disc1.pdf}\inspic{reg_abs.pdf}\hss}
\kern-5ex
\line{\hss\inspic{reg_c1notc2.pdf}\inspic{reg_sin.pdf}\hss}
\egroup
\kern-5ex
\caption/f
Plots of the functions $f_1$ (top left), $f_2$ (top right), $f_3$ (bottom left) and $f_4$ (bottom right), with their sampled data.  Under each of them there is a visualisation of the components of the limit vector~$\Bm Q$ computed with the Wendland's $\Cal C^0$ (blue), $\Cal C^2$ (red) and $\Cal C^4$ (black) functions.
\bigskip
\endinsert












\Red

\noindent TODO
\begitems
%* How to numerically compute Q, $\varepsilon$ doesn't have to be too small.
* Properties of the quantity~$\norm{\Bm Q}_1$, used to build the classifier.
%* Different $\phi$ detect different regularities.
* Comparison with $\Bm E$ and~$\Bm\alpha$ (and simply the native space norm).
%* ``Problems'' at the boundary and possible solutions.
%* Effect of noise in the data
\enditems


\Black



